<style>
  .header-wrap{
    max-width: 980px;
    margin: 18px auto 0;
    padding: 0 16px;
  }

  .topbar{
    border:1px solid #e5e7eb;
    border-radius:14px;
    padding:14px 16px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:#fff;
  }

  .left, .right{
    display:flex;
    align-items:center;
    gap:12px;
  }

  .brand{
    font-weight:800;
    letter-spacing:.4px;
  }

  .icon-btn{
    width:40px;
    height:40px;
    border:1px solid #e5e7eb;
    border-radius:12px;
    background:#fff;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    position:relative;
  }

  .badge{
    position:absolute;
    top:-6px;
    right:-6px;
    min-width:20px;
    height:20px;
    padding:0 6px;
    border-radius:999px;
    background:#0f1b3b;
    color:#fff;
    font-size:12px;
    font-weight:800;
    display:flex;
    align-items:center;
    justify-content:center;
    border:2px solid #fff;
  }

  .dropdown{
    position:relative;
  }

  .menu{
    position:absolute;
    top:46px;
    left:0;
    width:190px;
    background:#fff;
    border:1px solid #e5e7eb;
    border-radius:12px;
    padding:8px;
    box-shadow: 0 10px 30px rgba(0,0,0,.08);
    display:none;
    z-index:50;
  }
  .menu.show{ display:block; }

  .menu a{
    display:block;
    padding:10px 10px;
    border-radius:10px;
    text-decoration:none;
    color:#111827;
    font-weight:600;
  }
  .menu a:hover{ background:#f3f4f6; }

  .menu form{ margin:0; }
  .menu button{
    width:100%;
    text-align:left;
    padding:10px 10px;
    border-radius:10px;
    border:none;
    background:transparent;
    cursor:pointer;
    font-weight:700;
  }
  .menu button:hover{ background:#f3f4f6; }

  .searchbar{
    margin-top:12px;
    border:1px solid #e5e7eb;
    border-radius:14px;
    padding:10px 12px;
    display:flex;
    align-items:center;
    gap:10px;
    background:#f3f4f6;
  }
  .searchbar input{
    width:100%;
    border:none;
    outline:none;
    background:transparent;
    font-size:14px;
  }
  .searchbar button{
    border:none;
    background:transparent;
    cursor:pointer;
    font-size:16px;
  }
</style>

<div class="header-wrap">

  <div class="topbar">

    <div class="left">
      <div class="dropdown">
        <button class="icon-btn" type="button" onclick="toggleMenu('catMenu')">‚ò∞</button>


        <div id="catMenu" class="menu">
          <a href="/products?category=Skincare">Skin Care</a>
          <a href="/products?category=Haircare">Hair care</a>
          <a href="/products?category=Nails">Nails</a>
          <a href="/products?category=Vitamins">Vitamins</a>
        </div>
      </div>
    </div>


    <div class="brand"><a href="/">BLOOM Pharmacy</a></div>


    <div class="right">

      <a class="icon-btn" href="/cart" aria-label="Cart">
        üõí
        <% if (cartCount && cartCount > 0) { %>
          <span class="badge"><%= cartCount %></span>
        <% } %>
      </a>

      <div class="dropdown">
        <button class="icon-btn" type="button" onclick="toggleMenu('profileMenu')" aria-label="Profile">üë§</button>

        <div id="profileMenu" class="menu" style="left:auto; right:0;">
          <% if (!user) { %>
            <a href="/auth/sign-in">Sign In</a>
            <a href="/auth/sign-up">Sign Up</a>
          <% } else { %>
            <a href="/users/profile">Profile</a>
            <a href="/auth/sign-out">Sign Out</a>
          <% } %>
        </div>
      </div>

    </div>
  </div>


  <form class="searchbar" action="/products" method="GET">
    <input type="text" name="q" placeholder="Search products..." />
    <button type="submit">üîç</button>
  </form>

</div>

<script>
  function toggleMenu(id){
    const el = document.getElementById(id)
    if(!el) return
    el.classList.toggle("show")
  }


  document.addEventListener("click", (e) => {
    const catMenu = document.getElementById("catMenu")
    const profileMenu = document.getElementById("profileMenu")

    if (catMenu && !e.target.closest(".dropdown")) catMenu.classList.remove("show")
    if (profileMenu && !e.target.closest(".dropdown")) profileMenu.classList.remove("show")
  })
</script>
